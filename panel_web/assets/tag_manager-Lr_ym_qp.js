import{_ as ge,r as l,c as pe,w as me,o as s,a as u,b as o,n as J,d as k,v as U,t as g,e as De,F as z,f as L,g as N,h as O,i as ee,j as ve}from"./index-FNgSzaEe.js";import{a as v,b as i}from"./config-K_Uj3a-1.js";const Be={class:"color-picker"},qe={class:"color-values"},Re={__name:"ColorPicker",props:{modelValue:{type:String,default:"rgba(255,255,255,1)"}},emits:["update:modelValue"],setup(K,{emit:oe}){const T=K,C=oe,y=n=>{try{if(!n||typeof n!="string")return{r:255,g:255,b:255,a:1};const r=n.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);return r?{r:Math.min(255,Math.max(0,parseInt(r[1]))),g:Math.min(255,Math.max(0,parseInt(r[2]))),b:Math.min(255,Math.max(0,parseInt(r[3]))),a:Math.min(1,Math.max(0,parseFloat(r[4]||1)))}:{r:255,g:255,b:255,a:1}}catch(r){return console.error("Error parsing color:",r),{r:255,g:255,b:255,a:1}}},b=y(T.modelValue),p=l(b.a),m=n=>{const r=Math.round(n).toString(16);return r.length===1?"0"+r:r},_=l(`#${m(b.r)}${m(b.g)}${m(b.b)}`),x=pe(()=>{try{const n=_.value.replace("#",""),r=parseInt(n.slice(0,2),16),c=parseInt(n.slice(2,4),16),f=parseInt(n.slice(4,6),16);return`rgba(${r}, ${c}, ${f}, ${p.value})`}catch(n){return console.error("Error calculating rgba:",n),"rgba(255,255,255,1)"}}),M=()=>{C("update:modelValue",x.value)};return me(()=>T.modelValue,n=>{const{r,g:c,b:f,a:$}=y(n);_.value=`#${m(r)}${m(c)}${m(f)}`,p.value=$},{immediate:!0}),(n,r)=>(s(),u("div",Be,[o("div",{class:"color-preview",style:J({backgroundColor:x.value})},null,4),k(o("input",{type:"color","onUpdate:modelValue":r[0]||(r[0]=c=>_.value=c),onInput:M},null,544),[[U,_.value]]),r[2]||(r[2]=o("label",null,"Opacity:",-1)),k(o("input",{type:"range","onUpdate:modelValue":r[1]||(r[1]=c=>p.value=c),min:"0",max:"1",step:"0.01",onInput:M},null,544),[[U,p.value]]),o("div",qe,[o("span",null,"RGBA: "+g(x.value),1)])]))}},te=ge(Re,[["__scopeId","data-v-dcfcb4d5"]]),Fe={class:"container"},Pe={class:"tag-manager"},He={class:"tag-groups"},je=["onClick"],ze={class:"item-controls"},Le=["onClick"],Oe=["onClick"],Je=["onClick"],Ke={key:0,class:"tag-subgroups"},Qe=["onClick"],We={class:"item-controls"},Xe=["onClick"],Ye=["onClick"],Ze=["onClick"],et={key:1,class:"tags"},tt={class:"item-tag-tag"},ot={class:"item-controls"},at=["onClick"],lt=["onClick"],rt=["onClick"],nt={key:0,class:"modal"},st={class:"modal-content"},ut={type:"submit"},it={key:1,class:"modal"},dt={class:"modal-content"},ct={type:"submit"},vt={key:2,class:"modal"},gt={class:"modal-content"},pt={type:"submit"},mt={key:3,class:"modal"},bt={class:"modal-content"},ft=["value"],_t={key:0},yt={key:1},xt={__name:"tag_manager",props:{modelValue:{type:String,default:"rgba(255,255,255,1)"}},emits:["update:modelValue"],setup(K,{emit:oe}){const T=l([]),C=l([]),y=l([]),b=l(null),p=l(null),m=l(!1),_=l(!1),x=l(!1),M=l(!1),n=l(!1),r=l(!1),c=l(!1),f=l(""),$=l("rgba(255,255,255,1)"),S=l(""),E=l("rgba(255,255,255,1)"),V=l(""),I=l(""),w=l("rgba(255,255,255,1)"),D=l(null),G=l(null),Q=l(null),ae=l(null),h=l(""),F=l(""),P=l([]),H=l(""),le=l(1),re=l(1),ne=l(1),se=K,ue=t=>{try{if(!t||typeof t!="string")return{r:255,g:255,b:255,a:1};const e=t.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);return e?{r:Math.min(255,Math.max(0,parseInt(e[1]))),g:Math.min(255,Math.max(0,parseInt(e[2]))),b:Math.min(255,Math.max(0,parseInt(e[3]))),a:Math.min(1,Math.max(0,parseFloat(e[4]||1)))}:{r:255,g:255,b:255,a:1}}catch(e){return console.error("Error parsing color:",e),{r:255,g:255,b:255,a:1}}},j=ue(se.modelValue),ie=l(j.a),A=t=>{const e=Math.round(t).toString(16);return e.length===1?"0"+e:e},de=l(`#${A(j.r)}${A(j.g)}${A(j.b)}`);pe(()=>{try{const t=de.value.replace("#",""),e=parseInt(t.slice(0,2),16),a=parseInt(t.slice(2,4),16),d=parseInt(t.slice(4,6),16);return`rgba(${e}, ${a}, ${d}, ${ie.value})`}catch(t){return console.error("Error calculating rgba:",t),"rgba(255,255,255,1)"}}),me(()=>se.modelValue,t=>{const{r:e,g:a,b:d,a:Ue}=ue(t);de.value=`#${A(e)}${A(a)}${A(d)}`,ie.value=Ue},{immediate:!0});const B=async()=>{try{const t=await v.get(`${i}/tag/get_tag_groups`);T.value=t.data.data}catch(t){console.error("Error fetching tag groups:",t)}},q=async t=>{try{const e=await v.get(`${i}/tag/get_tag_subgroups`,{params:{group_id:t}});C.value=e.data.data}catch(e){console.error("Error fetching tag subgroups:",e)}},R=async t=>{try{const e=await v.get(`${i}/tag/get_tags`,{params:{subgroup_id:t}});y.value=e.data.data}catch(e){console.error("Error fetching tags:",e)}},be=t=>{b.value=t,p.value=null,C.value=[],y.value=[],q(t.id_index)},fe=t=>{p.value=t,y.value=[],R(t.id_index)},_e=()=>{f.value="",$.value="",n.value=!1,m.value=!0},ye=t=>{D.value=t,f.value=t.name,$.value=t.color?`${t.color.replace(/^#/,"")}`:"#ff7b02",le.value=t.alpha||1,n.value=!0,m.value=!0},W=()=>{m.value=!1},xe=async()=>{try{await v.post(`${i}/tag/add_tag_group`,{name:f.value,color:$.value}),B(),W()}catch(t){console.error("Error adding tag group:",t)}},$e=async()=>{try{await v.post(`${i}/tag/edit_tag_group`,{id_index:D.value.id_index,name:f.value,color:$.value,alpha:le.value}),B(),W()}catch(t){console.error("Error editing tag group:",t)}},he=async t=>{if(confirm("Are you sure you want to delete this tag group?"))try{await v.post(`${i}/tag/delete_tag_group`,{id_index:t}),B()}catch(e){console.error("Error deleting tag group:",e)}},X=(t,e,a)=>{ae.value=t,H.value=e,h.value=a,F.value="",ke(a),M.value=!0},ke=t=>{t==="group"?P.value=T.value:t==="subgroup"?P.value=C.value:t==="tag"&&(P.value=y.value)},Te=async()=>{try{let t="";h.value==="group"?t=`${i}/tag/move_tag_group`:h.value==="subgroup"?t=`${i}/tag/move_tag_subgroup`:h.value==="tag"&&(t=`${i}/tag/move_tag`),await v.post(t,{id_index:ae.value.id_index,reference_id_index:F.value,position:H.value}),h.value==="group"?B():h.value==="subgroup"?q(b.value.id_index):h.value==="tag"&&R(p.value.id_index),ce()}catch(t){console.error("Error moving item:",t)}},ce=()=>{M.value=!1},Ce=t=>{D.value=t,S.value="",E.value="",r.value=!1,_.value=!0},Me=t=>{G.value=t,S.value=t.name,E.value=t.color?`${t.color.replace(/^#/,"")}`:"#ff7b02",re.value=t.alpha||1,r.value=!0,_.value=!0},Y=()=>{_.value=!1},Se=async()=>{try{await v.post(`${i}/tag/add_tag_subgroup`,{group_id:D.value,name:S.value,color:E.value}),q(D.value),Y()}catch(t){console.error("Error adding tag subgroup:",t)}},Ee=async()=>{try{await v.post(`${i}/tag/edit_tag_subgroup`,{id_index:G.value.id_index,name:S.value,color:E.value,alpha:re.value}),q(G.value.group_id),Y()}catch(t){console.error("Error editing tag subgroup:",t)}},Ve=async t=>{if(confirm("Are you sure you want to delete this tag subgroup?"))try{await v.post(`${i}/tag/delete_tag_subgroup`,{id_index:t}),q(b.value.id_index)}catch(e){console.error("Error deleting tag subgroup:",e)}},Ie=t=>{G.value=t,V.value="",I.value="",w.value="",c.value=!1,x.value=!0},we=t=>{Q.value=t,V.value=t.text,I.value=t.desc,w.value=t.color?`${t.color.replace(/^#/,"")}`:"#ff7b02",ne.value=t.alpha||1,c.value=!0,x.value=!0},Z=()=>{x.value=!1},Ge=async()=>{try{await v.post(`${i}/tag/add_tag`,{subgroup_id:G.value,text:V.value,desc:I.value,color:w.value}),R(G.value),Z()}catch(t){console.error("Error adding tag:",t)}},Ae=async()=>{try{await v.post(`${i}/tag/edit_tag`,{id_index:Q.value.id_index,text:V.value,desc:I.value,color:w.value,alpha:ne.value}),R(Q.value.subgroup_id),Z()}catch(t){console.error("Error editing tag:",t)}},Ne=async t=>{if(confirm("Are you sure you want to delete this tag?"))try{await v.post(`${i}/tag/delete_tag`,{id_index:t}),R(p.value.id_index)}catch(e){console.error("Error deleting tag:",e)}};return De(B),(t,e)=>(s(),u("div",Fe,[e[30]||(e[30]=o("h1",null,"Tag Manager",-1)),o("div",Pe,[o("div",He,[e[15]||(e[15]=o("h2",null,"Tag Groups",-1)),o("ul",null,[(s(!0),u(z,null,L(T.value,a=>(s(),u("li",{key:a.id_index},[o("div",{class:"item-content",style:J({backgroundColor:a.color}),onClick:d=>be(a)},[o("span",null,g(a.name),1)],12,je),o("div",ze,[o("button",{onClick:d=>ye(a)},"Edit",8,Le),o("button",{onClick:d=>he(a.id_index)},"Delete",8,Oe),o("button",{onClick:d=>X(a,"before","group")},"Move",8,Je)])]))),128))]),o("button",{onClick:_e},"Add Tag Group")]),b.value?(s(),u("div",Ke,[e[16]||(e[16]=o("h2",null,"Tag Subgroups",-1)),o("ul",null,[(s(!0),u(z,null,L(C.value,a=>(s(),u("li",{key:a.id_index},[o("div",{class:"item-content",style:J({backgroundColor:a.color}),onClick:d=>fe(a)},[o("span",null,g(a.name),1)],12,Qe),o("div",We,[o("button",{onClick:d=>Me(a)},"Edit",8,Xe),o("button",{onClick:d=>Ve(a.id_index)},"Delete",8,Ye),o("button",{onClick:d=>X(a,"before","subgroup")},"Move",8,Ze)])]))),128))]),o("button",{onClick:e[0]||(e[0]=a=>Ce(b.value.id_index))},"Add Subgroup")])):N("",!0),p.value?(s(),u("div",et,[e[17]||(e[17]=o("h2",null,"Tags",-1)),o("ul",null,[(s(!0),u(z,null,L(y.value,a=>(s(),u("li",{key:a.id_index},[o("div",{class:"item-content-tag",style:J({backgroundColor:a.color})},[o("span",null,g(a.desc),1),o("span",tt,g(a.text),1)],4),o("div",ot,[o("button",{onClick:d=>we(a)},"Edit",8,at),o("button",{onClick:d=>Ne(a.id_index)},"Delete",8,lt),o("button",{onClick:d=>X(a,"before","tag")},"Move",8,rt)])]))),128))]),o("button",{onClick:e[1]||(e[1]=a=>Ie(p.value.id_index))},"Add Tag")])):N("",!0)]),m.value?(s(),u("div",nt,[o("div",st,[o("span",{class:"close",onClick:W},"×"),o("h2",null,g(n.value?"Edit Tag Group":"Add Tag Group"),1),o("form",{onSubmit:e[4]||(e[4]=O(a=>n.value?$e():xe(),["prevent"]))},[e[18]||(e[18]=o("label",{for:"tagGroupName"},"Name:",-1)),k(o("input",{type:"text",id:"tagGroupName","onUpdate:modelValue":e[2]||(e[2]=a=>f.value=a),required:""},null,512),[[U,f.value]]),e[19]||(e[19]=o("label",null,"Color:",-1)),ee(te,{modelValue:$.value,"onUpdate:modelValue":e[3]||(e[3]=a=>$.value=a)},null,8,["modelValue"]),o("button",ut,g(n.value?"Save":"Add"),1)],32)])])):N("",!0),_.value?(s(),u("div",it,[o("div",dt,[o("span",{class:"close",onClick:Y},"×"),o("h2",null,g(r.value?"Edit Tag Subgroup":"Add Tag Subgroup"),1),o("form",{onSubmit:e[7]||(e[7]=O(a=>r.value?Ee():Se(),["prevent"]))},[e[20]||(e[20]=o("label",{for:"tagSubgroupName"},"Name:",-1)),k(o("input",{type:"text",id:"tagSubgroupName","onUpdate:modelValue":e[5]||(e[5]=a=>S.value=a),required:""},null,512),[[U,S.value]]),e[21]||(e[21]=o("label",null,"Color:",-1)),ee(te,{modelValue:E.value,"onUpdate:modelValue":e[6]||(e[6]=a=>E.value=a)},null,8,["modelValue"]),o("button",ct,g(r.value?"Save":"Add"),1)],32)])])):N("",!0),x.value?(s(),u("div",vt,[o("div",gt,[o("span",{class:"close",onClick:Z},"×"),o("h2",null,g(c.value?"Edit Tag":"Add Tag"),1),o("form",{onSubmit:e[11]||(e[11]=O(a=>c.value?Ae():Ge(),["prevent"]))},[e[22]||(e[22]=o("label",{for:"tagText"},"Description:",-1)),k(o("input",{type:"text",id:"tagText","onUpdate:modelValue":e[8]||(e[8]=a=>I.value=a),required:""},null,512),[[U,I.value]]),e[23]||(e[23]=o("label",{for:"tagDesc"},"Tag:",-1)),k(o("textarea",{id:"tagDesc","onUpdate:modelValue":e[9]||(e[9]=a=>V.value=a),required:"",class:"styled-textarea",placeholder:"Enter your tag content here...",rows:"4"},null,512),[[U,V.value]]),e[24]||(e[24]=o("label",null,"Color:",-1)),ee(te,{modelValue:w.value,"onUpdate:modelValue":e[10]||(e[10]=a=>w.value=a)},null,8,["modelValue"]),o("button",pt,g(c.value?"Save":"Add"),1)],32)])])):N("",!0),M.value?(s(),u("div",mt,[o("div",bt,[o("span",{class:"close",onClick:ce},"×"),e[29]||(e[29]=o("h2",null,"Move Item",-1)),o("form",{onSubmit:e[14]||(e[14]=O(a=>Te(),["prevent"]))},[e[26]||(e[26]=o("label",{for:"referenceItemId"},"Reference Item:",-1)),k(o("select",{id:"referenceItemId","onUpdate:modelValue":e[12]||(e[12]=a=>F.value=a),required:""},[(s(!0),u(z,null,L(P.value,a=>(s(),u("option",{key:a.id_index,value:a.id_index},[h.value==="tag"?(s(),u("div",_t,g(a.desc+" ==> "+(a.text.length>30?a.text.slice(0,30)+"...":a.text)),1)):(s(),u("div",yt,g(a.name),1))],8,ft))),128))],512),[[ve,F.value]]),e[27]||(e[27]=o("label",{for:"position"},"Position:",-1)),k(o("select",{id:"position","onUpdate:modelValue":e[13]||(e[13]=a=>H.value=a),required:""},e[25]||(e[25]=[o("option",{value:"before"},"Before",-1),o("option",{value:"after"},"After",-1)]),512),[[ve,H.value]]),e[28]||(e[28]=o("button",{type:"submit"},"Move",-1))],32)])])):N("",!0)]))}},kt=ge(xt,[["__scopeId","data-v-39f925ca"]]);export{kt as default};
