import{_ as g,r,e as y,a as i,b as t,d as m,j as b,F as w,f as L,v as M,t as p,g as C,o as d}from"./index-FNgSzaEe.js";import{a as u,b as c}from"./config-K_Uj3a-1.js";const k={class:"home-container"},x={class:"file-selector"},F={class:"select-container"},Y={class:"custom-select"},A=["value"],$=["disabled"],E={class:"yaml-converter"},V={class:"input-group"},B={class:"file-input-container"},D=["disabled"],N={key:0,class:"status-message"},S={__name:"home",setup(T){const v=r([]),l=r(""),n=r(""),o=r(""),_=async()=>{try{const s=await u.get(c+"/api/file_list");v.value=s.data.data.filter(e=>e.path.endsWith(".db"))}catch(s){console.error("获取文件列表失败:",s)}},f=async()=>{if(l.value)try{const s=l.value.replace(/^userdatas_/,"").replace(/\.db$/,""),e=await u.post(c+"/api/set_language",{name:s});if(e.data.status==="success")alert(`成功切换到语言：${s}`);else throw new Error(e.data.message||"切换失败")}catch(s){console.error("文件切换失败:",s),alert(`文件切换失败：${s.message}`)}},h=async()=>{if(n.value)try{o.value="转换中...";const s=await u.post(c+"/api/convert_yaml",{yaml_file:n.value});if(s.data.status==="success")o.value="转换成功！",alert("YAML文件转换成功");else throw new Error(s.data.message||"转换失败")}catch(s){console.error("YAML转换失败:",s),o.value=`转换失败：${s.message}`,alert(`YAML转换失败：${s.message}`)}finally{setTimeout(()=>{o.value=""},5e3)}};return y(()=>{_()}),(s,e)=>(d(),i("div",k,[t("div",x,[e[4]||(e[4]=t("label",{for:"file-select"},"选择用户数据文件(默认根据系统语言自动加载)：",-1)),t("div",F,[t("div",Y,[m(t("select",{id:"file-select","onUpdate:modelValue":e[0]||(e[0]=a=>l.value=a)},[e[2]||(e[2]=t("option",{value:""},"请选择文件",-1)),(d(!0),i(w,null,L(v.value,a=>(d(),i("option",{key:a.path,value:a.name},p(a.name),9,A))),128))],512),[[b,l.value]]),e[3]||(e[3]=t("span",{class:"custom-arrow"},null,-1))]),t("button",{class:"confirm-btn",disabled:!l.value,onClick:f}," 确认切换 ",8,$)])]),t("div",E,[e[6]||(e[6]=t("h3",null,"YAML文件读取，存入Tag用户数据中（注意：如果数据过多处理速度会很慢）",-1)),t("div",V,[t("div",B,[e[5]||(e[5]=t("div",null,[t("h5",null,"路径格式例子：E:/Downloads/userdatas_zh_CN.yaml"),t("h5",null,"如果已经存在的对应tag路径，则不会重复创建，前提是tag的一级目录和二级目录的名称是一样的")],-1)),m(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=a=>n.value=a),placeholder:"输入YAML文件绝对路径"},null,512),[[M,n.value]])])]),t("button",{class:"convert-btn",disabled:!n.value.trim(),onClick:h}," 开始处理 ",8,D),o.value?(d(),i("div",N,p(o.value),1)):C("",!0)])]))}},z=g(S,[["__scopeId","data-v-a8397355"]]);export{z as default};
